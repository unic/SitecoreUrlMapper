<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">
  <UsingTask TaskName="TransformXml" AssemblyFile="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v10.0\Web\Microsoft.Web.Publishing.Tasks.dll"/>

    <!-- Included properties -->
    <Import Project="Servertype.props" />
    
    <!-- Transforming Different  Config-Files !-->
    <Target Name="GenerateConfigs">
        <Message Text="... for environment '$(Environment)' and servertype '$(Servertype)'."/>

        <!-- Transforming Unic.Settings.config ! -->
        <TransformXml Condition="Exists('..\App_Config\Include\Unic.Settings.$(Environment)')"
                        Source="..\App_Config\Include\Unic.Settings.base"
                        Transform="..\App_Config\Include\Unic.Settings.$(Environment)"
                        Destination="..\App_Config\Include\Unic.Settings.config"/>
        <TransformXml Condition="!Exists('..\App_Config\Include\Unic.Settings.$(Environment)')"
                        Source="..\App_Config\Include\Unic.Settings.base"
                        Transform="..\App_Config\Include\Unic.Settings.local"
                        Destination="..\App_Config\Include\Unic.Settings.config"/>

        <!--Transforming Web.config !-->
        <TransformXml Condition="'$(Servertype)' == 'delivery' and Exists('..\Web.config.delivery')"
                        Source="..\Web.config.base"
                        Transform="..\Web.config.delivery"
                        Destination="..\Web.config"/>
        <Copy Condition="'$(Servertype)' != 'delivery'" SourceFiles="..\Web.config.base" DestinationFiles="..\Web.config" SkipUnchangedFiles="True" />
    </Target>
</Project>
